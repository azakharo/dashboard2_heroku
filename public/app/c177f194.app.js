"use strict";angular.module("demoarmApp",["ngCookies","ngResource","ngSanitize","btford.socket-io","ui.router","ui.bootstrap","formly","formlyBootstrap","restService"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(a,b,c,d){b.otherwise("/dashboard2/preview"),c.html5Mode(!0),d.interceptors.push("authInterceptor")}]).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(a,b,c,d){return{request:function(a){return a.headers=a.headers||{},c.get("token")&&(a.headers.Authorization="Bearer "+c.get("token")),a},responseError:function(a){return 401===a.status?(d.path("/login"),c.remove("token"),b.reject(a)):b.reject(a)}}}]).run(["$rootScope","$location","Auth",function(a,b,c){a.$on("$stateChangeStart",function(a,d){c.isLoggedInAsync(function(a){d.authenticate&&!a&&b.path("/login")})})}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"app/account/login/login.html",controller:"LoginCtrl"}).state("signup",{url:"/signup",templateUrl:"app/account/signup/signup.html",controller:"SignupCtrl"}).state("settings",{url:"/settings",templateUrl:"app/account/settings/settings.html",controller:"SettingsCtrl",authenticate:!0})}]),angular.module("demoarmApp").controller("LoginCtrl",["$scope","Auth","$location","$window",function(a,b,c,d){a.user={},a.errors={},a.login=function(d){a.submitted=!0,d.$valid&&b.login({email:a.user.email,password:a.user.password}).then(function(){c.path("/")})["catch"](function(b){a.errors.other=b.message})},a.loginOauth=function(a){d.location.href="/auth/"+a}}]),angular.module("demoarmApp").controller("SettingsCtrl",["$scope","User","Auth",function(a,b,c){a.errors={},a.changePassword=function(b){a.submitted=!0,b.$valid&&c.changePassword(a.user.oldPassword,a.user.newPassword).then(function(){a.message="Password successfully changed."})["catch"](function(){b.password.$setValidity("mongoose",!1),a.errors.other="Incorrect password",a.message=""})}}]),angular.module("demoarmApp").controller("SignupCtrl",["$scope","Auth","$location","$window",function(a,b,c,d){a.user={},a.errors={},a.register=function(d){a.submitted=!0,d.$valid&&b.createUser({name:a.user.name,email:a.user.email,password:a.user.password}).then(function(){c.path("/")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){d[c].$setValidity("mongoose",!1),a.errors[c]=b.message})})},a.loginOauth=function(a){d.location.href="/auth/"+a}}]),angular.module("demoarmApp").controller("AdminCtrl",["$scope","$http","Auth","User",function(a,b,c,d){a.users=d.query(),a["delete"]=function(b){d.remove({id:b._id}),angular.forEach(a.users,function(c,d){c===b&&a.users.splice(d,1)})}}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("admin",{url:"/admin",templateUrl:"app/admin/admin.html",controller:"AdminCtrl"})}]);var mod=angular.module("demoarmApp");mod.controller("CardsCtrl",["$scope","$interval","$log","$q","myRest",function(a,b,c,d,e){a.cards=[],e.getCurrencies().then(function(b){e.getCards(b).then(function(b){a.cards=b,e.getEvents().then(function(b){e.calcBalance(a.cards,b)})})});var f=b(function(){e.getCurrencies().then(function(b){e.getCards(b).then(function(b){e.getEvents().then(function(c){e.calcBalance(b,c);var d=angular.copy(b);if(a.cards.length>0)for(var f=0;f<d.length;f++){var g=a.cards[f],h=d[f];if(!angular.equals(g,h))for(var i=0;i<g.bags.length;i++){var j=g.bags[i],k=h.bags[i];j.balance!==k.balance?k.wasUpdated=!0:k.wasUpdated=!1}}a.cards=d})})})},5e3);a.$on("$destroy",function(){b.cancel(f)})}]),angular.module("demoarmApp").controller("DashboardCtrl",["$scope",function(a){a.message="Hello"}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("dashboard",{"abstract":!0,url:"/dashboard",templateUrl:"app/dashboard/dashboard.html",controller:"DashboardCtrl"}).state("dashboard.ready",{url:"/preview",views:{cards:{templateUrl:"app/dashboard/cards.html",controller:"CardsCtrl"},turnover:{templateUrl:"app/dashboard/turnover.html",controller:"TurnoverCtrl"},events:{templateUrl:"app/dashboard/events.html",controller:"EventsCtrl"},transactions:{templateUrl:"app/dashboard/transactions.html",controller:"TransactionsCtrl"},flow:{templateUrl:"app/dashboard/flow.html",controller:"FlowCtrl"}}})}]);var mod=angular.module("demoarmApp");mod.controller("EventsCtrl",["$scope","$interval","$log","$q","myRest",function(a,b,c,d,e){function f(){e.getEvents().then(function(b){a.events.forEach(function(a){a.wasUpdated=!1});var c=[];_(b).forEach(function(b){var d=_(a.events).find(function(a){return a.srvTransactionID===b.srvTransactionID});return d?!1:void c.push(b)}),c.length>0&&(_(c).reverse(),c.forEach(function(b){b.wasUpdated=!0,a.events.unshift(b)}))})}var g=null;a.events=[],e.getEvents().then(function(c){a.events=c,g=b(f,5e3)}),a.$on("$destroy",function(){g&&b.cancel(g)})}]),mod.filter("eventOperationFilter",function(){return function(a){var b="неизвестная";return"replenishment"===a?b="пополнение":"payment"===a&&(b="списание"),b}});var mod=angular.module("demoarmApp");mod.controller("FlowCtrl",["$scope","$timeout","$log","myRest",function(a,b,c,d){function e(a){$("#flow-chart").highcharts({chart:{type:"spline",animation:Highcharts.svg,marginRight:10,events:{load:function(){var a=this.series[0];setInterval(function(){d.getTurnover().then(function(b){if(b&&b!==f){var c=(new Date).getTime(),d=b,e=a.data.length>20;a.addPoint([c,d],!0,e),f=b}})},2e3)}}},title:{text:"",style:{fontSize:"30px"}},xAxis:{type:"datetime",tickPixelInterval:150},yAxis:{title:{text:"Кол-во оплативших, чел."},plotLines:[{value:0,width:1,color:"#808080"}],allowDecimals:!1,floor:0},tooltip:{formatter:function(){return"<b>кол-во оплативших: "+Highcharts.numberFormat(this.y,0)+"</b><br/>"+Highcharts.dateFormat("%Y-%m-%d %H:%M:%S",this.x)+"<br/>"}},legend:{enabled:!1},exporting:{enabled:!1},series:[{name:"passengers",data:function(){var b=[];if(a.length>0){var c=_.uniq(a,"timestamp");c.length>20&&(c=c.slice(c.length-20)),_(c).forEach(function(a){b.push({x:a.timestamp.toDate().getTime(),y:a.value})})}else{var d,e=(new Date).getTime();for(d=-19;0>=d;d+=1)b.push({x:e+2e3*d,y:0})}return b}()}]})}var f=-1;Highcharts.setOptions({global:{useUTC:!1}}),d.getTurnoverHistory().then(function(a){f=a.length>0?a[a.length-1].value:0,e(a)})}]),angular.module("demoarmApp").controller("TransactionsCtrl",["$scope",function(a){a.transactions=["transaction 1","transaction 2","transaction 3"]}]);var mod=angular.module("demoarmApp");mod.controller("TurnoverCtrl",["$scope","$timeout","$log","myRest",function(a,b,c,d){function e(a){$("#chart").highcharts({chart:{type:"line",animation:Highcharts.svg,marginRight:10,events:{load:function(){var a=this.series[0];setInterval(function(){d.getTurnover().then(function(b){if(b&&b!==f){var c=(new Date).getTime(),d=b,e=a.data.length>20;a.addPoint([c,d],!0,e),f=b}})},2e3)}}},title:{text:"",style:{fontSize:"30px"}},xAxis:{type:"datetime",tickPixelInterval:150},yAxis:{title:{text:"Кол-во пассажиров, чел."},plotLines:[{value:0,width:1,color:"#808080"}],allowDecimals:!1,floor:0},tooltip:{formatter:function(){return"<b>кол-во пассажиров: "+Highcharts.numberFormat(this.y,0)+"</b><br/>"+Highcharts.dateFormat("%Y-%m-%d %H:%M:%S",this.x)+"<br/>"}},legend:{enabled:!1},exporting:{enabled:!1},series:[{name:"passengers",data:function(){var b=[];if(a.length>0){var c=_.uniq(a,"timestamp");c.length>20&&(c=c.slice(c.length-20)),_(c).forEach(function(a){b.push({x:a.timestamp.toDate().getTime(),y:a.value})})}else{var d,e=(new Date).getTime();for(d=-19;0>=d;d+=1)b.push({x:e+2e3*d,y:0})}return b}(),step:!0}]})}var f=-1;Highcharts.setOptions({global:{useUTC:!1}}),d.getTurnoverHistory().then(function(a){f=a.length>0?a[a.length-1].value:0,e(a)})}]);var mod=angular.module("demoarmApp");mod.controller("CardProcCtrl",["$scope","$interval","$log","$q","myRest",function(a,b,c,d,e){a.cards=[],e.getCurrencies().then(function(b){e.getCards(b).then(function(b){e.getEvents().then(function(c){e.calcBalance(b,c),e.calcTransactions(b,c),b=_.sortBy(b,function(a){return-a.latestTrans.timestamp}),a.cards=b})})});var f=b(function(){e.getCurrencies().then(function(b){e.getCards(b).then(function(b){e.getEvents().then(function(c){e.calcBalance(b,c),e.calcTransactions(b,c),b=_.sortBy(b,function(a){return-a.latestTrans.timestamp});var d=angular.copy(b);if(a.cards.length>0)for(var f=0;f<d.length;f++){var g=a.cards[f],h=d[f];if(!angular.equals(g,h))for(var i=0;i<g.bags.length;i++){var j=g.bags[i],k=h.bags[i];j.balance!==k.balance?(k.wasUpdated=!0,h.justChanged=!0):k.wasUpdated=!1}}a.cards=d})})})},5e3);a.$on("$destroy",function(){b.cancel(f)});var g={success:"panel-primary",warning:"panel-warning",danger:"panel-danger"};a.getCardPanelClass=function(a){return g[a]}}]),mod.filter("bagActivePeriodFilter",function(){return function(a){var b="",c="",d="DD.MM.YYYY";return a.activePeriodStart&&(b=a.activePeriodStart.format(d)),a.activePeriodFinish&&(c=a.activePeriodFinish.format(d)),format("{} - {}",b,c)}}),mod.filter("cardTitleFilter",function(){return function(a){var b=format("UID: {}",a.id);return a.isESEK&&(b+=" (ЕСЭК)"),b}});var mod=angular.module("demoarmApp");mod.controller("Dashboard2Ctrl",["$scope","$state",function(a,b){$(window).resize(function(){b.reload()})}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("dashboard2",{"abstract":!0,url:"/dashboard2",templateUrl:"app/dashboard2/dashboard2.html",controller:"Dashboard2Ctrl"}).state("dashboard2.ready",{url:"/preview",views:{cardproc:{templateUrl:"app/dashboard2/cardproc.html",controller:"CardProcCtrl"},pies:{templateUrl:"app/dashboard2/pies.html",controller:"PiesCtrl"},transactions:{templateUrl:"app/dashboard2/transactions.html",controller:"TransactionsCtrl"}}})}]);var mod=angular.module("demoarmApp");mod.controller("PiesCtrl",["$scope","$interval","$log","myRest","$timeout",function(a,b,c,d,e){function f(a){var b=[];a.forEach(function(a){var c;c=n.hasOwnProperty(a.privilege)?{y:a.transactions,name:n[a.privilege].name,color:n[a.privilege].color}:{y:a.transactions,name:a.privilege},b.push(c)}),$("#privileges-chart").highcharts({chart:{backgroundColor:null,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,marginTop:0},credits:{enabled:!1},title:{text:null},exporting:{enabled:!1},tooltip:{headerFormat:"",pointFormat:"{point.name}: <b>{point.y:.0f}</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},series:[{type:"pie",name:"privileges",data:b}],legend:{labelFormat:"<b>{name}</b>: {y:.0f}"}})}function g(a){var b=[];a.forEach(function(a){var c={y:a.transactions,name:o[a.cardType].name,color:o[a.cardType].color};b.push(c)}),$("#cards-chart").highcharts({chart:{backgroundColor:null,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,marginTop:0},credits:{enabled:!1},title:{text:null},exporting:{enabled:!1},tooltip:{headerFormat:"",pointFormat:"{point.name}: <b>{point.y: .0f}</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},series:[{type:"pie",name:"cards",data:b}],legend:{labelFormat:"<b>{name}</b>: {y:.0f}"}})}function h(b){d.getEvents().then(function(c){if(p!==a.timePeriod||!angular.equals(c,q)){p=angular.copy(a.timePeriod),q=angular.copy(c),c=j(c,b),a.noData=0===c.length;var d=_.groupBy(c,function(a){return a.currency.privilege}),h=[];Object.keys(d).forEach(function(a){var b={};b.privilege=a,b.transactions=d[a].length,h.push(b)});var k=_.groupBy(c,function(a){return a.card.isESEK?"esek":"others"}),l=[];Object.keys(k).forEach(function(a){var b={};b.cardType=a,b.transactions=k[a].length,l.push(b)}),f(h),g(l),e(i,100),0===c.length&&($("#privileges-chart").highcharts().destroy(),$("#cards-chart").highcharts().destroy())}})}function i(){var a=$("#pies-wrapper").width(),b=$("#pies-wrapper").height(),c=$("#privileges-chart").highcharts(),d=$("#cards-chart").highcharts();if(400===b){var e=$("#my-right-up").height()-$("#pies-header").height()-10;c.setSize(a/2,e,!1),d.setSize(a/2,e,!1)}else 800===b&&(c.setSize(a,b/2,!1),d.setSize(a,b/2,!1))}function j(a,b){var c=moment();switch(b){case"day":c.startOf("day");break;case"week":c.startOf("week");break;case"month":c.startOf("month");break;case"year":c.startOf("year");break;default:k(format("pie charts: UNEXPECTED time period '{}'",b))}return _.filter(a,function(a){return a.timestamp.isAfter(c)})}function k(a){c.debug(a)}if(a.timePeriod="year",localStorage){var l=localStorage.getItem("timePeriod");l&&(a.timePeriod=l)}a.noData=!1,h(a.timePeriod);var m=b(function(){h(a.timePeriod)},5e3);a.$on("$destroy",function(){b.cancel(m)}),a.onTimePeriodChanged=function(){localStorage&&localStorage.setItem("timePeriod",a.timePeriod),h(a.timePeriod)};var n={unprivileged:{name:"Нет льгот",color:"#000000"}},o={esek:{name:"ЕСЭК",color:"#FF4500"},others:{name:"не ЕСЭК",color:"#F08080"}},p=angular.copy(a.timePeriod),q=void 0}]);var mod=angular.module("demoarmApp");mod.controller("TransactionsCtrl",["$scope","$interval","$timeout","$log","myRest",function(a,b,c,d,e){function f(a){var b=_.map(a,"name"),c=[],d=[];a.forEach(function(a){c.push(a.successes),d.push(a.errors)}),$("#trans-chart").highcharts({chart:{type:"column",backgroundColor:null},credits:{enabled:!1},title:{text:null},exporting:{enabled:!1},xAxis:{categories:b},yAxis:{min:0,allowDecimals:!1,title:{text:"Кол-во транзакций"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"white"}}},legend:{align:"right",x:-5,verticalAlign:"top",y:10,floating:!0,backgroundColor:null,borderColor:"#CCC",borderWidth:0,shadow:!1},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y+"<br/>Всего: "+this.point.stackTotal}},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white",style:{textShadow:"0 0 3px black"}}}},series:[{name:"Успешные",data:c,color:"#90EE90"},{name:"Неуспешные",data:d,color:"#F08080"}]})}function g(a){return a.timestamp.format("DD.MM")}function h(a){return"ww"+a.timestamp.format("WW")}function i(a){return a.timestamp.format("MMMM YYYY")}function j(a){return a.timestamp.format("YYYY")}function k(a,b){if("day"===b||"week"===b){var c=moment().subtract(1,"years");return _.filter(a,function(a){return a.timestamp.isAfter(c)})}return a}function l(b){e.getEvents().then(function(d){if(r!==a.aggrPeriod||!angular.equals(d,s)){r=angular.copy(a.aggrPeriod),s=angular.copy(d),d=k(d,b),_(d).reverse();var e=_.groupBy(d,q[b]),g=[];Object.keys(e).forEach(function(a){var b={};b.name=a;var c=0,d=0;e[a].forEach(function(a){a.isSuccess?c+=1:d+=1}),b.successes=c,b.errors=d,g.push(b)}),g=n(g),f(g),c(m,100)}})}function m(){var a=$("#trans-chart").width(),b=($("#trans-chart").height(),$("#my-right-down").height()-$("#trans-header").height()-10),c=$("#trans-chart").highcharts();c.setSize(a,b,!1)}function n(a){return a.length>30?_.takeRight(a,30):a}if(a.aggrPeriod="day",localStorage){var o=localStorage.getItem("aggrPeriod");o&&(a.aggrPeriod=o)}l(a.aggrPeriod);var p=b(function(){l(a.aggrPeriod)},5e3);a.$on("$destroy",function(){b.cancel(p)}),a.onAggrPeriodChanged=function(){localStorage&&localStorage.setItem("aggrPeriod",a.aggrPeriod),l(a.aggrPeriod)},moment.locale("en",{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"]});var q={day:g,week:h,month:i,year:j},r=angular.copy(a.aggrPeriod),s=void 0}]),angular.module("demoarmApp").controller("MainCtrl",["$scope","$http","socket",function(a,b,c){a.awesomeThings=[],b.get("/api/things").success(function(b){a.awesomeThings=b,c.syncUpdates("thing",a.awesomeThings)}),a.addThing=function(){""!==a.newThing&&(b.post("/api/things",{name:a.newThing}),a.newThing="")},a.deleteThing=function(a){b["delete"]("/api/things/"+a._id)},a.$on("$destroy",function(){c.unsyncUpdates("thing")})}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("main",{url:"/main",templateUrl:"app/main/main.html",controller:"MainCtrl"})}]);var mod=angular.module("demoarmApp");mod.controller("TestCtrl",["$scope","$log","myRest",function(a,b,c){a.userInput={},a.formFields=[{key:"turnover",type:"input",templateOptions:{type:"number",min:0,label:"New turnover value",placeholder:"Enter integer",required:!1}},{key:"balanceAdd",type:"input",templateOptions:{type:"number",min:0,label:"Balance Addition",placeholder:"Enter positive integer",required:!1}}],a.onPostTurnoverBtnClick=function(){c.postTurnover(moment(),a.userInput.turnover),a.userInput.turnover=void 0},a.onReplenishBalanceBtnClick=function(){c.replenishBalance(moment(),a.userInput.balanceAdd),a.userInput.balanceAdd=void 0},a.onPaymentBtnClick=function(){c.makePayment(moment())}}]),angular.module("demoarmApp").config(["$stateProvider",function(a){a.state("test",{url:"/test",templateUrl:"app/test/test.html",controller:"TestCtrl"})}]),angular.module("demoarmApp").factory("Auth",["$location","$rootScope","$http","User","$cookieStore","$q",function(a,b,c,d,e,f){var g={};return e.get("token")&&(g=d.get()),{login:function(a,b){var h=b||angular.noop,i=f.defer();return c.post("/auth/local",{email:a.email,password:a.password}).success(function(a){return e.put("token",a.token),g=d.get(),i.resolve(a),h()}).error(function(a){return this.logout(),i.reject(a),h(a)}.bind(this)),i.promise},logout:function(){e.remove("token"),g={}},createUser:function(a,b){var c=b||angular.noop;return d.save(a,function(b){return e.put("token",b.token),g=d.get(),c(a)},function(a){return this.logout(),c(a)}.bind(this)).$promise},changePassword:function(a,b,c){var e=c||angular.noop;return d.changePassword({id:g._id},{oldPassword:a,newPassword:b},function(a){return e(a)},function(a){return e(a)}).$promise},getCurrentUser:function(){return g},isLoggedIn:function(){return g.hasOwnProperty("role")},isLoggedInAsync:function(a){g.hasOwnProperty("$promise")?g.$promise.then(function(){a(!0)})["catch"](function(){a(!1)}):a(g.hasOwnProperty("role")?!0:!1)},isAdmin:function(){return"admin"===g.role},getToken:function(){return e.get("token")}}}]),angular.module("demoarmApp").factory("User",["$resource",function(a){return a("/api/users/:id/:controller",{id:"@_id"},{changePassword:{method:"PUT",params:{controller:"password"}},get:{method:"GET",params:{id:"me"}}})}]),angular.module("demoarmApp").factory("Modal",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}}}}]),angular.module("demoarmApp").directive("mongooseError",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){return d.$setValidity("mongoose",!0)})}}}),angular.module("demoarmApp").controller("NavbarCtrl",["$scope","$location","Auth",function(a,b,c){a.menu=[{title:"Home",link:"/"}],a.isCollapsed=!0,a.isLoggedIn=c.isLoggedIn,a.isAdmin=c.isAdmin,a.getCurrentUser=c.getCurrentUser,a.logout=function(){c.logout(),b.path("/login")},a.isActive=function(a){return a===b.path()}}]);var mod=angular.module("restService",[]);mod.service("myRest",["$http","$q","$log","$rootScope","$interval","$window",function(a,b,c,d,e,f){function g(){var b=a({method:"get",url:E+"accounts"});return b.then(A,z)}function h(b){var c=a({method:"get",url:E+format("accounts/{}/bags",b)});return c.then(A,z)}function i(b){var c=a({method:"get",url:E+format("accounts/{}/transactions",b)});return c.then(A,z)}function j(b){var c=a({method:"get",url:E+format("accounts/{}/medias",b)});return c.then(A,z)}function k(){var b=a({method:"get",url:E+"applications"});return b.then(A,z)}function l(b){var c=a({method:"get",url:E+format("applications/{}/currencies",b)});return c.then(A,z)}function m(){var a=[],c=b.defer();return g().then(function(b){var d=0;b.forEach(function(e){i(e.Id).then(function(e){a=a.concat(e),d===b.length-1&&(a=_.sortBy(a,function(a){return-a.Timestamp}),c.resolve(a)),d+=1})})},function(a){c.reject(a)}),c.promise}function n(){var b=a({method:"get",url:E+"organizations"});return b.then(A,z)}function o(b){var c=a({method:"get",url:E+format("organizations/{}/vehicles",b)});return c.then(A,z)}function p(b,c){var d=a({method:"get",url:E+format("organizations/{}/vehicles/{}/turnovers",b,c)});return d.then(A,z)}function q(){var a=[],c=b.defer();return k().then(function(b){0===b.length&&c.resolve(a);var d=b[0].Id;l(d).then(function(b){b.forEach(function(b){var c={};c.srvID=b.Id,c.code=b.Code,c.name=b.Info.Title,c.privilege=b.Exemption?b.Exemption:"unprivileged",a.push(c)}),c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}),c.promise}function r(a){var c=[],d=b.defer();return g().then(function(b){var e=0;b.forEach(function(f){var g={};g.id=+f.Number,g.srvAccountID=f.Id,g.state="success",g.isESEK=void 0!==f.UserId&&null!==f.UserId,g.bags=[],j(f.Id).then(function(i){if(i&&i.length>0){var j=i[0];g.RFID=j.RFID;var k=_(j.States).find(function(a){return"Activated"===a.State});k&&(g.activatedAt=moment.unix(k.Timestamp))}h(f.Id).then(function(f){f.forEach(function(b){var c={};c.srvID=b.Id,c.activePeriodStart=moment.unix(b.TimeFrame.StartTimestamp),c.activePeriodFinish=moment.unix(b.TimeFrame.FinishTimestamp),c.currency=_.find(a,function(a){return a.srvID===b.CurrencyId}),g.bags.push(c)}),c.push(g),e===b.length-1&&d.resolve(c),e+=1})})})},function(a){d.reject(a)}),d.promise}function s(a,b){var c=void 0;return _(a).forEach(function(a){return _(a.bags).forEach(function(d){return d.srvID===b?(c=a,!1):void 0}),c?!1:void 0}),c}function t(a,b){var c=void 0;return _(a).forEach(function(a){return _(a.bags).forEach(function(a){return a.srvID===b?(c=a,!1):void 0}),c?!1:void 0}),c}function u(){var a=b.defer();return q().then(function(b){r(b).then(function(b){m().then(function(c){var d=[],e=0;c.forEach(function(a){var c={};c.id=e+1,c.srvTransactionID=a.Id,c.timestamp=moment.unix(a.Timestamp),c.card=s(b,a.BagId),c.bag=t(b,a.BagId),c.operation=a.Type;var f=t(b,a.BagId);f&&(c.currency=f.currency),c.value=a.Value,c.isSuccess="Accepted"===a.States[0].State,d.push(c),e+=1}),a.resolve(d)},function(b){a.reject(b)})},function(b){a.reject(b)})},function(b){a.reject(b)}),a.promise}function v(a,b){a.forEach(function(a){a.bags.forEach(function(a){var c=_.filter(b,function(b){return b.bag.srvID===a.srvID}),d=0;c.forEach(function(a){"replenishment"===a.operation?d+=a.value:"payment"===a.operation&&(d-=a.value)}),a.balance=d})})}function w(a,b){a.forEach(function(a){a.bags.forEach(function(a){var c=_.filter(b,function(b){return b.bag.srvID===a.srvID});c&&c.length>0?a.transCount=c.length:a.transCount=0});var c=_.filter(b,function(b){return b.card.srvAccountID===a.srvAccountID});if(c&&c.length>0?a.latestTrans=c[0]:a.latestTrans=void 0,a.latestTrans){var d=_.find(a.bags,function(b){return b.srvID===a.latestTrans.bag.srvID});d&&(d.isLatestTrans=!0)}})}function x(){var a=void 0,c=b.defer();return n().then(function(b){if(0===b.length)return void c.resolve(a);var d=b[0];o(d.Id).then(function(b){if(0===b.length)return void c.resolve(a);var e=b[0];p(d.Id,e.Id).then(function(b){if(0===b.length)return void c.resolve(a);var d=b[b.length-1];c.resolve(d.Quantity)},function(a){c.reject(a)})},function(a){c.reject(a)})},function(a){c.reject(a)}),c.promise}function y(){var a=[],c=b.defer();return n().then(function(b){0===b.length&&c.resolve(a);var d=b[0];o(d.Id).then(function(b){0===b.length&&c.resolve(a);var e=b[0];p(d.Id,e.Id).then(function(b){0===b.length&&c.resolve(a),_(b).forEach(function(b){var c={};c.timestamp=moment.unix(b.Timestamp),c.value=b.Quantity,a.push(c)}),c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})},function(a){c.reject(a)}),c.promise}function z(a){return 503==a.status||0==a.status?d.isRestUnavailable=!0:d.isRestUnavailable?(d.isRestUnavailable=!1,f.location.reload()):d.isRestUnavailable=!1,b.reject(angular.isObject(a.data)&&a.data.message?a.data.message:"An unknown error occurred.")}function A(a){return d.isRestUnavailable=!1,a.data}function B(b,c){var d=a({method:"post",url:E+"organizations/55643625c98e560001000001/vehicles/5566ee65ffa2621d995c1e1a/turnovers",data:[{Timestamp:b.unix(),Distance:1e3,Quantity:c}]});return d.then(A,z)}function C(b,c){var d=a({method:"post",url:E+"replenishment",data:{CurrencyCode:"TR-BL",RFID:"1111-2222-3333-4444",Timestamp:b.unix(),Value:c}});return d.then(A,z)}function D(b){var c=a({method:"post",url:E+"payment",data:{RFID:"1111-2222-3333-4444",Timestamp:b.unix(),ServiceId:"556436c457ab120001000001",ApplicationId:"55643649dade7e0001000001",OrganizationId:"55643625c98e560001000001"}});return c.then(A,z)}var E="http://cp-prod.corp.sarov-itc.ru/";return a.defaults.headers.common["Content-type"]="application/json",{getAccounts:g,getAccountBags:h,getAccountTransactions:i,getApps:k,getAppCurrencies:l,getAllTransactions:m,getCurrencies:q,getCards:r,findCardByBagID:s,findBag:t,getEvents:u,calcBalance:v,calcTransactions:w,getTurnover:x,getTurnoverHistory:y,postTurnover:B,replenishBalance:C,makePayment:D}}]),angular.module("demoarmApp").factory("socket",["socketFactory",function(a){var b=io("",{path:"/socket.io-client"}),c=a({ioSocket:b});return{socket:c,syncUpdates:function(a,b,d){d=d||angular.noop,c.on(a+":save",function(a){var c=_.find(b,{_id:a._id}),e=b.indexOf(c),f="created";c?(b.splice(e,1,a),f="updated"):b.push(a),d(f,a,b)}),c.on(a+":remove",function(a){var c="deleted";_.remove(b,{_id:a._id}),d(c,a,b)})},unsyncUpdates:function(a){c.removeAllListeners(a+":save"),c.removeAllListeners(a+":remove")}}}]),function(){var a,b,c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j=[].slice;a=function(a){function b(a){this.message=a}return i(b,a),b.prototype.name="ValueError",b}(Error),e="cannot switch from implicit to explicit numbering",c="cannot switch from explicit to implicit numbering",b=function(b){return null==b&&(b={}),function(){var d,g,h,i,k,l;return l=arguments[0],d=2<=arguments.length?j.call(arguments,1):[],h=0,g=i=!1,k="cannot switch from {} to {} numbering",l.replace(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g,function(j,k,l,m){var n,o,p;if(k)return k;if(l.length){if(i)throw new a(e);g=!0,n=null!=(o=f(d,l))?o:""}else{if(g)throw new a(c);i=!0,n=null!=(p=d[h++])?p:""}return Object.prototype.hasOwnProperty.call(b,m)?b[m](n):n})}},f=function(a,b){var c;for(/^(\d+)([.]|$)/.test(b)||(b="0."+b);c=/(.+?)[.](.+)/.exec(b);)a=g(a,c[1]),b=c[2];return g(a,b)},g=function(a,b){var c;return c=a[b],"function"==typeof c?c.call(a):c},d=b({}),d.create=b,d.extend=function(a,c){var d;d=b(c),a.format=function(){return d.apply(null,[this].concat(j.call(arguments)))}},"undefined"!=typeof module?module.exports=d:"function"==typeof define&&define.amd?define(d):window.format=d}.call(this),angular.module("demoarmApp").run(["$templateCache",function(a){a.put("app/account/login/login.html",'<div ng-include=&quot;components/navbar/navbar.html&quot;></div><div class=container><div class=row><div class=col-sm-12><h1>Login</h1><p>Accounts are reset on server restart from<code>server/config/seed.js</code>. Default account is<code>test@test.com</code>/<code>test</code></p><p>Admin account is<code>admin@admin.com</code>/<code>admin</code></p></div><div class=col-sm-12><form name=form ng-submit=login(form) novalidate class=form><div class=form-group><label>Email</label><input name=email ng-model=user.email class="form-control"></div><div class=form-group><label>Password</label><input type=password name=password ng-model=user.password class="form-control"></div><div class="form-group has-error"><p ng-show="form.email.$error.required &amp;&amp; form.password.$error.required &amp;&amp; submitted" class=help-block>Please enter your email and password.</p><p class=help-block>{{ errors.other }}</p></div><div><button type=submit class="btn btn-inverse btn-lg btn-login">Login</button> <a href=/signup class="btn btn-default btn-lg btn-register">Register</a></div><hr><div><a href="" ng-click=loginOauth(&quot;facebook&quot;) class="btn btn-facebook"><i class="fa fa-facebook"></i> Connect with Facebook</a> <a href="" ng-click=loginOauth(&quot;google&quot;) class="btn btn-google-plus"><i class="fa fa-google-plus"></i> Connect with Google+</a> <a href="" ng-click=loginOauth(&quot;twitter&quot;) class="btn btn-twitter"><i class="fa fa-twitter"></i> Connect with Twitter</a></div></form></div></div><hr></div>'),a.put("app/account/settings/settings.html",'<div ng-include=&quot;components/navbar/navbar.html&quot;></div><div class=container><div class=row><div class=col-sm-12><h1>Change Password</h1></div><div class=col-sm-12><form name=form ng-submit=changePassword(form) novalidate class=form><div class=form-group><label>Current Password</label><input type=password name=password ng-model=user.oldPassword mongoose-error="" class="form-control"><p ng-show=form.password.$error.mongoose class=help-block>{{ errors.other }}</p></div><div class=form-group><label>New Password</label><input type=password name=newPassword ng-model=user.newPassword ng-minlength=3 required class="form-control"><p ng-show="(form.newPassword.$error.minlength || form.newPassword.$error.required) &amp;&amp; (form.newPassword.$dirty || submitted)" class=help-block>Password must be at least 3 characters.</p></div><p class=help-block>{{ message }}</p><button type=submit class="btn btn-lg btn-primary">Save changes</button></form></div></div></div>'),a.put("app/account/signup/signup.html",'<div ng-include=&quot;components/navbar/navbar.html&quot;></div><div class=container><div class=row><div class=col-sm-12><h1>Sign up</h1></div><div class=col-sm-12><form name=form ng-submit=register(form) novalidate class=form><div ng-class="{ &quot;has-success&quot;: form.name.$valid &amp;&amp; submitted,        &quot;has-error&quot;: form.name.$invalid &amp;&amp; submitted }" class=form-group><label>Name</label><input name=name ng-model=user.name required class="form-control"><p ng-show="form.name.$error.required &amp;&amp; submitted" class=help-block>A name is required</p></div><div ng-class="{ &quot;has-success&quot;: form.email.$valid &amp;&amp; submitted,        &quot;has-error&quot;: form.email.$invalid &amp;&amp; submitted }" class=form-group><label>Email</label><input type=email name=email ng-model=user.email required mongoose-error="" class="form-control"><p ng-show="form.email.$error.email &amp;&amp; submitted" class=help-block>Doesn\'t look like a valid email.</p><p ng-show="form.email.$error.required &amp;&amp; submitted" class=help-block>What\'s your email address?</p><p ng-show=form.email.$error.mongoose class=help-block>{{ errors.email }}</p></div><div ng-class="{ &quot;has-success&quot;: form.password.$valid &amp;&amp; submitted,        &quot;has-error&quot;: form.password.$invalid &amp;&amp; submitted }" class=form-group><label>Password</label><input type=password name=password ng-model=user.password ng-minlength=3 required mongoose-error="" class="form-control"><p ng-show="(form.password.$error.minlength || form.password.$error.required) &amp;&amp; submitted" class=help-block>Password must be at least 3 characters.</p><p ng-show=form.password.$error.mongoose class=help-block>{{ errors.password }}</p></div><div><button type=submit class="btn btn-inverse btn-lg btn-login">Sign up</button> <a href=/login class="btn btn-default btn-lg btn-register">Login</a></div><hr><div><a href="" ng-click=loginOauth(&quot;facebook&quot;) class="btn btn-facebook"><i class="fa fa-facebook"></i> Connect with Facebook</a> <a href="" ng-click=loginOauth(&quot;google&quot;) class="btn btn-google-plus"><i class="fa fa-google-plus"></i> Connect with Google+</a> <a href="" ng-click=loginOauth(&quot;twitter&quot;) class="btn btn-twitter"><i class="fa fa-twitter"></i> Connect with Twitter</a></div></form></div></div><hr></div>'),
a.put("app/admin/admin.html",'<div ng-include=&quot;components/navbar/navbar.html&quot;></div><div class=container><p>The delete user and user index api routes are restricted to users with the \'admin\' role.</p><ul class=list-group><li ng-repeat="user in users" class=list-group-item><strong>{{user.name}}</strong><br><span class=text-muted>{{user.email}}</span><a ng-click=delete(user) class=trash><span class="glyphicon glyphicon-trash pull-right"></span></a></li></ul></div>'),a.put("app/dashboard/cards.html",'<!--h2(style="text-align: center") Процессинг карт--><div id=table-wrapper style="height: 290px; overflow-y: auto"><table style="background: white; margin-bottom: 0px" class="table table-bordered table-hover table-condensed"><tbody ng-repeat="card in cards"><tr class=no-border><th style="color: blue; font-size: 110%" class="w25 no-border">Карта {{ card.id }}</th><th class="w25 no-border"><small>RFID {{ card.RFID }}</small></th><th colspan=2 class="w25 no-border text-right"><small>активирована {{ card.activatedAt.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</small></th></tr><tr><th style="padding-left: 30px" class=w25>Кошелек</th><th class="w25 text-right">Баланс</th><th class="w25 text-right">Начало действия</th><th class="w25 text-right">Конец действия</th></tr><tr ng-repeat="bag in card.bags"><td style="padding-left: 30px" class=w25>{{ bag.currency.name }}</td><td ng-class="{ animated: bag.wasUpdated, infinite: bag.wasUpdated, flash: bag.wasUpdated, \'table-cell-changed\': bag.wasUpdated, \'bg-success\': bag.wasUpdated }" class="w25 text-right">{{ bag.balance }}</td><td class="w25 text-right">{{ bag.activePeriodStart.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</td><td class="w25 text-right">{{ bag.activePeriodFinish.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</td></tr></tbody></table></div>'),a.put("app/dashboard/dashboard.html",'<div id=dashboard class=container-fluid><div class=row><div class="row-same-height row-full-height"><div class="col-xs-6 col-xs-height col-full-height"><div class=item><div ui-view=cards style="padding-left: 5px; padding-right: 5px" class=content></div></div></div><div class="col-xs-6 col-xs-height col-full-height"><div class=item><div ui-view=turnover class=content></div></div></div></div></div><div class=row><div class="row-same-height row-full-height"><div class="col-xs-6 col-xs-height col-full-height"><div class=item><div ui-view=events style="padding-left: 5px; padding-right: 5px" class=content></div></div></div><!--.col-xs-3.col-xs-height.col-full-height--><!--  .item--><!--    .content(ui-view="transactions", style="padding-left: 5px; padding-right: 5px;")--><div class="col-xs-6 col-xs-height col-full-height"><div class=item><div ui-view=flow class=content></div></div></div></div></div></div><!-- Show server unavailable message, if necessary--><div id=msg-server-unavailable ng-show=isRestUnavailable><alert type=danger class=text-center>Сервер <b>http://cp-prod.corp.sarov-itc.ru</b> недоступен</alert></div><footer class=text-center><p class=copyright>Copyright &copy; 2015 &mdash;&nbsp;<a href="http://sarov-itc.ru/">ИТЦ Система-Саров</a></p></footer><!--*********************************************************--><!-- Flex experiment--><!--#dashboard.vw100.vh100--><!--  .flex-container.h50--><!--    .flex-item.w50(ui-view="cards")--><!--    .flex-item.w50(ui-view="turnover")--><!--  .flex-container.h50--><!--    .flex-item.w50(ui-view="events")--><!--    .flex-item.w50(ui-view="flow")--><!--*********************************************************--><!--=============================================================================--><!-- Experiments with the layout--><!--.vw100.vh100--><!--  .w50.h100.left(style="background: grey")--><!--    .w100.h50(ui-view="cards", style="background: red")--><!--    .w50.h50.left(ui-view="events", style="background: green")--><!--    .w50.h50.left(ui-view="transactions", style="background: blue")--><!--  .w50.h100.left(style="background: lightgrey")--><!--    .w100.h50(ui-view="turnover", style="background: lightgreen")--><!--    .w100.h50(ui-view="flow", style="background: lightblue")--><!--=============================================================================-->'),a.put("app/dashboard/events.html",'<!--h2(style="text-align: center") События--><div id=table-header-wrapper><table style="margin-bottom: 0px" class=table><thead><tr class=info><th style="width: 5%"></th><th class=w20>Время</th><th class=w20>Карта</th><th class=w20>Операция</th><th class=w20>Валюта</th><th style="text-align: right; width: 15%">Сумма</th></tr></thead></table></div><div id=table-wrapper style="height: 290px; overflow-y: auto"><table style="background: white; margin-bottom: 0px" class="table table-bordered table-hover table-condensed"><tbody ng-repeat="event in events"><tr ng-class="{ \'new-event\': event.wasUpdated }"><td style="width: 5%"><span style="color: green" ng-if=event.isSuccess class="fa fa-check-circle"></span><span style="color: red" ng-if=!event.isSuccess class="fa fa-minus-circle"></span></td><td class=w20>{{ event.timestamp.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</td><td class=w20>{{ event.card.id }}</td><td class=w20>{{ event.operation | eventOperationFilter }}</td><td class=w20>{{ event.currency.name | lowercase }}</td><td style="text-align: right; width: 15%">{{ event.value }}</td></tr></tbody></table></div><!--pre {{ transactions }}-->'),a.put("app/dashboard/flow.html",'<!--h2(style="text-align: center") Пассажиропоток--><div id=flow-chart></div>'),a.put("app/dashboard/transactions.html",'<h2>Транзакции</h2><ul><li ng-repeat="transaction in transactions">{{ transaction }}</li></ul>'),a.put("app/dashboard/turnover.html",'<!--h2(style="text-align: center") Пассажирооборот--><div id=chart></div>'),a.put("app/dashboard2/cardproc.html",'<div id=cardproc-wrapper><!--.section-title Процессинг карт--><div id=card-panels-container><div ng-repeat="card in cards" ng-class="{ animated: card.justChanged &amp;&amp; cards.length &gt; 1, fadeInUp: card.justChanged &amp;&amp; cards.length &gt; 1 }" class=card-panel-container><div ng-class=getCardPanelClass(card.state) class=panel><div class="card-panel-heading panel-heading"><div class=card-num>{{ card | cardTitleFilter }}</div><div class=card-rfid><small>RFID {{ card.RFID }}</small></div><div class=card-activation-time><small>активирована {{ card.activatedAt.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</small></div></div><div class=panel-body><table style="background: white; margin-bottom: 0px" class="table table-bordered table-hover table-condensed no-border"><tbody><tr><th style="padding-left: 30px" class="w25 no-border">Способ оплаты</th><th class="w25 no-border text-right">Баланс</th><th class="w25 no-border text-right">Период действия</th><th class="w25 no-border text-right">Кол-во операций</th></tr><tr ng-repeat="bag in card.bags" ng-class="{ \'latest-bag\': bag.isLatestTrans }"><td style="padding-left: 30px" class="w25 no-border">{{ bag.currency.name }}</td><td class="w25 no-border text-right"><span ng-class="{ animated: bag.wasUpdated, infinite: bag.wasUpdated, flash: bag.wasUpdated, \'table-cell-changed\': bag.wasUpdated, \'bg-success\': bag.wasUpdated }" style="padding: 5px 10px">{{ bag.balance }}</span></td><td class="w25 no-border text-right">{{ bag | bagActivePeriodFilter }}</td><td class="w25 no-border text-right">{{ bag.transCount }}</td></tr></tbody></table></div><div class="card-panel-footer panel-footer"><div class=trans-status><span style="color: green" ng-if=card.latestTrans.isSuccess class="fa fa-check-circle"></span><span style="color: red" ng-if=!card.latestTrans.isSuccess class="fa fa-minus-circle"></span></div><div class=trans-dt>{{ card.latestTrans.timestamp.toDate() | date:\'yyyy-MM-dd HH:mm:ss\' }}</div><div class=trans-curr>{{ card.latestTrans.currency.name }}</div><div class=trans-oper>{{ card.latestTrans.operation | eventOperationFilter }}</div><div class=trans-val>{{ card.latestTrans.value }}</div></div></div></div></div></div>'),a.put("app/dashboard2/dashboard2.html",'<div id=wrapper class="w100 vh100"><div id=header><div id=header-logo><a href="http://sarov-itc.ru/" target=_blank><img width=238 height=32 alt=Лого src="assets/images/cc4d91a0.logo.png"></a></div><div id=header-text>Система обработки электронных карт</div><div id=header-right-part>Placeholder</div></div><div id=content><div id=left-part ui-view=cardproc></div><div id=right-part><div id=my-right-up ui-view=pies class=right-up></div><div id=my-right-down ui-view=transactions class=right-down></div></div></div><footer id=footer class=text-center>Copyright &copy; 2015 &mdash;&nbsp;<a href="http://sarov-itc.ru/" target=_blank>ИТЦ Система-Саров</a></footer><!-- Show server unavailable message, if necessary--><div id=msg-server-unavailable ng-show=isRestUnavailable><alert type=danger class=text-center>Сервер <b>http://cp-prod.corp.sarov-itc.ru</b> недоступен</alert></div></div>'),a.put("app/dashboard2/pies.html",'<div id=pies-header><div id=pies-title>Распределение по видам льгот и типам карт</div><div id=pies-period-buttons><!--pre {{ timePeriod || \'undefined\'}}--><div class=btn-group><label ng-model=timePeriod btn-radio="\'day\'" ng-change=onTimePeriodChanged() class="btn btn-primary">День</label><!--label.btn.btn-primary(ng-model=\'timePeriod\', btn-radio="\'week\'", ng-change="onTimePeriodChanged()") Неделя--><label ng-model=timePeriod btn-radio="\'month\'" ng-change=onTimePeriodChanged() class="btn btn-primary">Месяц</label><label ng-model=timePeriod btn-radio="\'year\'" ng-change=onTimePeriodChanged() class="btn btn-primary">Год</label></div></div></div><div id=pies-no-data-msg ng-show=noData>НЕТ ДАННЫХ</div><div id=pies-wrapper ng-hide=noData><div id=privileges-chart></div><div id=cards-chart></div></div>'),a.put("app/dashboard2/transactions.html",'<div id=trans-header><div id=trans-title>Количество операций</div><div id=trans-aggr-period-buttons><div class=btn-group><label ng-model=aggrPeriod btn-radio="\'day\'" ng-change=onAggrPeriodChanged() class="btn btn-primary">День</label><!--label.btn.btn-primary(ng-model=\'aggrPeriod\', btn-radio="\'week\'", ng-change="onAggrPeriodChanged()") Неделя--><label ng-model=aggrPeriod btn-radio="\'month\'" ng-change=onAggrPeriodChanged() class="btn btn-primary">Месяц</label><label ng-model=aggrPeriod btn-radio="\'year\'" ng-change=onAggrPeriodChanged() class="btn btn-primary">Год</label></div></div></div><div id=trans-chart></div>'),a.put("app/main/main.html",'<div ng-include=&quot;components/navbar/navbar.html&quot;></div><header id=banner class=hero-unit><div class=container><h1>\'Allo, \'Allo!</h1><p class=lead>Kick-start your next web app with Angular Fullstack</p><img src=assets/images/66adba84.yeoman.png alt="I\'m Yeoman"></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Features:</h1><ul ng-repeat="thing in awesomeThings" class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6"><li><a href=# tooltip={{thing.info}}>{{thing.name}}<button type=button ng-click=deleteThing(thing) class=close>×</button></a></li></ul></div></div><form class=thing-form><label>Syncs in realtime across clients</label><p class=input-group><input placeholder="Add a new thing here." ng-model=newThing class="form-control"><span class=input-group-btn><button type=submit ng-click=addThing() class="btn btn-primary">Add New</button></span></p></form></div><footer class=footer><div class=container><p>Angular Fullstack v2.0.13 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></div></footer>'),a.put("app/test/test.html",'<div class="container col-md-4 col-md-offset-4"><form novalidate><h1>Simulate actions</h1><formly-form model=userInput fields=formFields form=myForm><button type=button ng-click=onPostTurnoverBtnClick() ng-disabled=!userInput.turnover class="btn btn-primary">Post Turnover</button><button type=button ng-click=onReplenishBalanceBtnClick() style="margin-left: 10px" ng-disabled=!userInput.balanceAdd class="btn btn-primary">Replenish Balance</button><button type=button ng-click=onPaymentBtnClick() style="margin-left: 10px" class="btn btn-primary">Pay!</button></formly-form></form></div>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div></div><div class=modal-footer><button ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button></div>'),a.put("components/navbar/navbar.html",'<div ng-controller=NavbarCtrl class="navbar navbar-default navbar-static-top"><div class=container><div class=navbar-header><button type=button ng-click="isCollapsed = !isCollapsed" class=navbar-toggle><span class=sr-only>Toggle navigation</span><span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button><a href="/" class=navbar-brand>demoarm</a></div><div id=navbar-main collapse=isCollapsed class="navbar-collapse collapse"><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li><li ng-show=isAdmin() ng-class="{active: isActive(&quot;/admin&quot;)}"><a href=/admin>Admin</a></li></ul><ul class="nav navbar-nav navbar-right"><li ng-hide=isLoggedIn() ng-class="{active: isActive(&quot;/signup&quot;)}"><a href=/signup>Sign up</a></li><li ng-hide=isLoggedIn() ng-class="{active: isActive(&quot;/login&quot;)}"><a href=/login>Login</a></li><li ng-show=isLoggedIn()><p class=navbar-text>Hello {{ getCurrentUser().name }}</p></li><li ng-show=isLoggedIn() ng-class="{active: isActive(&quot;/settings&quot;)}"><a href=/settings><span class="glyphicon glyphicon-cog"></span></a></li><li ng-show=isLoggedIn() ng-class="{active: isActive(&quot;/logout&quot;)}"><a href="" ng-click=logout()>Logout</a></li></ul></div></div></div>')}]);